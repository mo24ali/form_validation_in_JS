<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- jQuery then Parsley -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/parsleyjs@2.9.2/dist/parsley.min.js"></script>

  <title>ParsleyJS Form Validation — Fixed</title>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

  <form id="myForm"
        class="bg-white p-6 rounded-lg shadow-md w-full max-w-sm"
        data-parsley-validate>
    <h2 class="text-center text-lg font-semibold mb-4">Register</h2>

    <label class="block mb-1">Full Name</label>
    <input type="text" name="name" id="name" placeholder="John Doe"
           class="w-full p-2 border rounded mb-2"
           required
           data-parsley-pattern="^[a-zA-Z\s]+$"
           data-parsley-pattern-message="Name should contain only letters and spaces"
           data-parsley-minlength="3"
           data-parsley-minlength-message="Name must be at least 3 characters">

    <label class="block mb-1">Email</label>
    <input type="email" name="email" id="mail" placeholder="you@example.com"
           class="w-full p-2 border rounded mb-2"
           required data-parsley-type="email"
           data-parsley-type-message="Please enter a valid email address">

    <label class="block mb-1">Password</label>
    <input type="password" name="pwd" id="paswd" placeholder="Password"
           class="w-full p-2 border rounded mb-2"
           required data-parsley-minlength="8"
           data-parsley-minlength-message="Password must be at least 8 characters"
           data-parsley-uppercase="1" data-parsley-lowercase="1" data-parsley-number="1">

    <label class="block mb-1">Confirm Password</label>
    <input type="password" id="confirm" placeholder="Confirm password"
           class="w-full p-2 border rounded mb-4"
           required data-parsley-equalto="#paswd"
           data-parsley-equalto-message="Passwords must match">

    <button type="submit" id="submitBtn" class="w-full bg-blue-600 text-white p-2 rounded">Submit</button>
  </form>

  <!-- <script>
    window.Parsley.addValidator('uppercase', {
      requirementType: 'number',
      validateString: function (value, requirement) {
        return ((value.match(/[A-Z]/g) || []).length >= requirement);
      },
      messages: { en: 'Password must contain at least one uppercase letter.' }
    });
    window.Parsley.addValidator('lowercase', {
      requirementType: 'number',
      validateString: function (value, requirement) {
        return ((value.match(/[a-z]/g) || []).length >= requirement);
      },
      messages: { en: 'Password must contain at least one lowercase letter.' }
    });
    window.Parsley.addValidator('number', {
      requirementType: 'number',
      validateString: function (value, requirement) {
        return ((value.match(/[0-9]/g) || []).length >= requirement);
      },
      messages: { en: 'Password must contain at least one number.' }
    });

    // initialize Parsley
    const $form = $('#myForm').parsley();

    document.querySelector('#myForm').addEventListener('submit', function (e) {
      e.preventDefault(); // <- stop the browser from sending a POST

      $form.validate();

      // If the form passes Parsley validation, redirect (GET) to success page
      if ($form.isValid()) {
        // Option 1: navigate to a success page (GET) - safe for static servers
        window.location.href = 'validationpassed.html';

        // Option 2: display a success message instead of navigating
        // alert('Validation passed — do your submit logic here.');
      } else {
        const firstError = document.querySelector('.parsley-error');
        if (firstError) firstError.focus();
      }
    });

    $('#myForm').on('field:validated', function () {
      $(this).find('input').each(function () {
        const $el = $(this);
        if ($el.hasClass('parsley-success')) {
          $el.removeClass('border-red-500').addClass('border-green-500');
        } else if ($el.hasClass('parsley-error')) {
          $el.removeClass('border-green-500').addClass('border-red-500');
        } else {
          $el.removeClass('border-red-500 border-green-500');
        }
      });
    });
  </script> -->
</body>
</html>